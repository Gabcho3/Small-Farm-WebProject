@using SmallFarm.Core.Models.Order

@model List<OrderViewModel>

@{
    ViewData["Title"] = "My Orders";
    int orderCount = 0;
}

@if (!Model.Any())
{
    <h3 class="text-center mt-5">You have not any orders yet!</h3>
}

else
{
    <h3 href="#" class=" text-center text-primary fs-1" aria-current="true">
        Orders
    </h3>

    <div class="row d-flex gap-3">
        @foreach (var order in Model)
        {
            orderCount++;

            <div class="card bg-info mb-3 col-3">
                <div class="card-header text-center fw-bold">Order № @orderCount</div>

                <ul class="list-group list-group-flush">
                    @foreach (var product in order.Products)
                    {
                        <div class="list-group-item bg-info text-success d-flex justify-content-between">
                            <a asp-controller="Product" asp-action="Details" asp-route-id="@product.Id" class="text-decoration-none text-success">
                                <strong>@product.Name</strong>
                            </a>
                            <span>@product.Quantity * @product.Price €</span>
                        </div>
                    }
                    <span class="list-group-item bg-info d-flex justify-content-between" style="height:2.5em;">
                        <strong>Total price:</strong>
                        <span>@order.TotalPrice €</span>
                    </span>
                    <span class="list-group-item bg-info text-secondary" style="height:3.5em;font-size:14px">Ordered on @order.OrderedDate.ToString("G")</span>
                </ul>
            </div>
        }
    </div>
}

@if (TempData["hasOrdered"] != null)
{
    <div class="toast show end-0 position-absolute" style="bottom:4.3em;z-index:11" role="alert" aria-live="assertive" aria-atomic="true">
        <div class="toast-header bg-warning">
            <strong class="me-auto">Order Info</strong>
            <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
        </div>
        <div class="toast-body bg-info">
            Order is successful! Thank you for using Small Farm!
        </div>
    </div>
}
